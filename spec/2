RSpec.describe ToArel do
  it 'has a version number' do
    expect(ToArel::VERSION).not_to be nil
  end

  describe '.parse' do
    describe 'SELECT' do
      it 'returns an arel select manager' do
        expect(ToArel.parse('SELECT 1 FROM posts').class).to eq Arel::SelectManager
      end

      it 'has the correct table set' do
        expect(ToArel.parse('SELECT 1 FROM posts').froms).to eq [
          Arel::Table.new('posts')
        ]
      end

      describe 'to arel and back' do
        it 'binding' do
          visitor = Arel::Visitors::MySQL.new connection
          engine = OpenStruct.new(connection: OpenStruct.new(visitor: visitor))

          Arel::Table.engine = engine

          x = ToArel.parse('SELECT 1 FROM posts')

          binding.pry
        end
      end
    end

    xdescribe 'UPDATE' do
    end

    xdescribe 'INSERT' do
    end
  end
end
